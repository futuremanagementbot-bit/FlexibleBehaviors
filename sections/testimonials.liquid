<!-- Testimonials Section -->
<section class="section section--cream" aria-label="Customer testimonials">
  <div class="container">
    {% render 'section-header',
      title: section.settings.heading,
      subtitle: section.settings.subheading
    %}

    <div class="testimonial-grid">
      {%- for block in section.blocks -%}
        <div class="testimonial-card fade-in-up" data-delay="{{ forloop.index }}" {{ block.shopify_attributes }}>

          <!-- Star rating -->
          <div class="testimonial-card__stars" aria-label="{{ block.settings.rating }} out of 5 stars">
            {%- for i in (1..5) -%}
              {%- if i <= block.settings.rating -%}
                {% render 'icon', name: 'star' %}
              {%- else -%}
                {% render 'icon', name: 'star-empty' %}
              {%- endif -%}
            {%- endfor -%}
          </div>

          <!-- Quote (Lora italic) -->
          <blockquote class="testimonial-card__quote">
            {{ block.settings.quote }}
          </blockquote>

          <!-- Author -->
          <div>
            <cite class="testimonial-card__author">{{ block.settings.author }}</cite>
            {%- if block.settings.role != blank -%}
              <p class="testimonial-card__role">{{ block.settings.role }}</p>
            {%- endif -%}
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Testimonials",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section heading",
      "default": "What Our Community Says"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Section subheading"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote text",
          "default": "These tools have changed our daily routine. Finally something affordable that actually works."
        },
        {
          "type": "text",
          "id": "author",
          "label": "Author name",
          "default": "Sarah M."
        },
        {
          "type": "text",
          "id": "role",
          "label": "Author role",
          "default": "BCBA"
        },
        {
          "type": "range",
          "id": "rating",
          "label": "Star rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Testimonials",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "quote": "These tools have changed our daily routine. Finally something affordable that actually works.",
            "author": "Sarah M.",
            "role": "BCBA",
            "rating": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "As a parent, I was overwhelmed by how expensive everything was. Flexible Behaviors made it possible.",
            "author": "James R.",
            "role": "Parent",
            "rating": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "The quality is amazing and the price point is perfect for our clinic. We've ordered for all our therapists.",
            "author": "Dr. Kim L.",
            "role": "Clinical Director",
            "rating": 5
          }
        }
      ]
    }
  ]
}
{% endschema %}
